<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=10">
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta http-equiv="Cache-Control" content="no-store">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="google" value="notranslate">
    <title>Well自定义页面</title>

    {% for css in cssOrderd %}
      <link href="{{css.path}}" rel="stylesheet">
    {% endfor %}

  </head>
  <!--[if lt IE 9]> <script src="{{helper.staticPrefix()}}/js/html5shiv-3.7.3/dist/html5shiv.min.js"></script> <script src="{{helper.staticPrefix()}}/js/respond/respond.min.js"></script> <![endif]-->
  <body class="page-config">
    <input type="hidden" name="systemUnitId" id="systemUnitId" value="{{systemUnitId}}">
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">

          <a class="navbar-brand" href="#">Well自定义页面——{{ title }}</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li>
              <div class="btn-group well-form-fontsize0">
                <button id="btn_view_ref_resource" class="btn btn-primary hide" href="#">查看引用资源</button>
                <button id="btn_enable_json_viewer" class="btn btn-primary hide" href="#">开启JSON查看器</button>
                <button id="btn_disable_json_viewer" class="btn btn-primary hide" href="#">关闭JSON查看器</button>
                {% if containerSupportsWysiwyg %}
                  <button id="btn_enable_wysiwyg" class="btn btn-primary hide" href="#">开启所见即所得</button>
                  <button id="btn_disable_wysiwyg" class="btn btn-primary hide" href="#">关闭所见即所得</button>
                {% endif %}
                <button id="btn_preview" class="btn btn-primary hide" href="#">预览</button>
                <button id="btn_save" class="btn btn-primary hide" href="#">保存</button>
                <button id="btn_save_new_version" class="btn btn-primary hide" href="#">保存新版本</button>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <input id="pi_uuid" name="pi_uuid" value="{{ piUuid }}" type="hidden"/>
      <input id="page_uuid" name="page_uuid" value="{{ pageUuid }}" type="hidden"/>
      <input id="sys_id" name="sys_id" value="${sysId}" type="hidden"/>
      <div div="row-fluid">
        <!-- 左边导航 -->
        <div class="designer-sidebar-nav">
          <div class="panel-group" id="accordion">
            {% for categoryName, comp in componentMap %}
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse{{ loop.index }}">{{categoryName}}</a>
                  </h4>
                </div>

                <div id="collapse{{ loop.index }}" class="panel-collapse collapse  {% if loop.index == 1 %}in{% endif %}">
                  <div class="panel-body">
                    <ul class="list-group">
                      {% for cp in comp %}
                        <li class="list-group-item" type="{{cp.id}}" jsmodule="{{ cp.defineJs }}">
                          <span class="badge"></span>{{cp.name}}
                          <div class="widget ui-draggable" jsmodule="{{ cp.defineJs }}">
                            <div class="widget-header">
                              <div class="widget-actions">
                                {% if cp.configurable %}
                                  <a class="btn-edit">编辑</a>
                                {% endif %}
                                <a class="btn-delete">删除</a>
                              </div>
                              <div class="widget-handle" title="{{cp.name}}">
                                <span class="widget-title">{{cp.name}}</span>
                                <span class="ref-widget-title"></span>
                                <span>
                                  <a class="btn-json-viewer hide">
                                    <i class="fa fa-camera fa-large"></i>
                                  </a>
                                </span>
                              </div>
                            </div>
                            <div class="widget-body">{{cp.previewHtml|safe}}</div>
                          </div>
                        </li>
                      {% endfor %}
                    </ul>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>

        <!-- 页面容器 -->
        <div class="web-app-container container-fluid ui-sortable" style="min-height: 660px;">
          <div class="container-json-viewer">
            <a class="btn-container-json-viewer hide">
              <i class="fa fa-camera fa-large"></i>
            </a>
          </div>
          <div class="container-actions">
            <a class="btn_portal_config hide">门户设置</a>
          </div>
        </div>
      </div>
    </div>
    <div id="tmp_div" style="display: none;"></div>
    <div id="preview_html"></div>
    <div id="jsonview_template" style="display: none;">
      <div class="row row-jsonview">
        <div class="col-sm-12">
          <button class="btn btn-collapse">折叠</button>
          <button class="btn btn-expand">展开</button>
          <button class="btn btn-toggle">切换</button>
          <button class="btn btn-toggle-level1">切换一级</button>
          <button class="btn btn-toggle-level2">切换两级</button>
          <button class="btn btn-toggle-level3">切换三级</button>
          <div class="jsonview"></div>
        </div>
      </div>
    </div>

  </body>

  <script type="text/javascript" src="{{helper.staticPrefix()}}/js/requirejs/require.js"></script>
  <script>

    window.ctx = "";
    var WebApp = window.WebApp || {};
    window.backendUrl = '{{helper.backendUrl()}}';
    window.staticPrefix = '{{helper.staticPrefix()}}';
    requirejs.onError = function (error) {
      throw error;
    }

    requirejs.config({{ requirejsConfigJson | safe }});

    WebApp.environment = {};

    WebApp.environment = {
      "app_version": "7.0"
    };
    WebApp.currentUserAppData = {{ userAppDataJson | safe }};
    WebApp.containerDefaults = {{ containerDefaultOptionsJson | safe }};
    WebApp.widgetDefaults = {{ componentDefaultOptionsJson | safe }};
    WebApp.configJsModules = WebApp.configJsModules || {};
    WebApp.containerJsModule = '{{containerJsModule}}';
    WebApp.environment = {};
    //WebApp.componentDevJs={};  组件配置关联选择的二开脚本汇总，在页面定义保存时候自动注册到后端生成功能类
    // WebApp.pageDefinition = WebApp.pageDefiniton = {{ pageDefinitonJson }} || {};
    // WebApp.requestInfo = {{ requestInfo }} || {};

    require({{ javascriptsJson | safe }}, function () {
      appContext.init(WebApp.currentUserAppData);
      requirejs(['js/design/app_page_config']);
    });
  </script>
</html>
