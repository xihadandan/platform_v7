1、fixInitBody选项使updateRow支持不刷新列表更新

Index: WebContent/resources/bootstrap-table/1.11.0/js/bootstrap-table.js
===================================================================
--- WebContent/resources/bootstrap-table/1.11.0/js/bootstrap-table.js	(revision 210019)
+++ WebContent/resources/bootstrap-table/1.11.0/js/bootstrap-table.js	(working copy)
@@ -1665,18 +1665,21 @@
         this.options.pageNumber = +$(event.currentTarget).text();
         this.updatePagination(event);
     };
-
+	BootstrapTable.prototype.fixDataIndex = function(idx) {
+		// fix data-index
+		var that = this;
+    	that.$body.find('tr[data-index]').each(function(idx, element){
+    		var $element = $(element);
+    		$element.attr("data-index", idx).data("index", idx).find("td.bs-seqno").text(idx+1);
+    		$element.find("td.bs-checkbox>input[data-index]").attr("data-index", idx).data("index", idx);
+    	});
+	}
     BootstrapTable.prototype.initBody = function (fixedScroll) {
         var that = this,
             html = [],
             data = this.getData();
         // 
-        var dataLength = data.length,
-        appendBody = that.options.fixInitBody && $.isArray(that.appendData);
-        if(true === appendBody) {
-        	data = that.appendData;
-        	dataLength -= that.appendData.length;
-        }
+        var appendBody = that.options.fixInitBody && $.isArray(that.appendData);
         this.trigger('pre-body', data);
 
         this.$body = this.$body || this.$el.find('>tbody');
@@ -1690,6 +1693,9 @@
             this.pageFrom = 1;
             this.pageTo = data.length;
         }
+        if(true === appendBody) {
+        	this.pageFrom += (data.length - that.appendData.length);
+        }
         for (var i = this.pageFrom - 1; i < this.pageTo; i++) {
             var key,
                 item = data[i],
@@ -1730,7 +1736,7 @@
                 sprintf(' %s', htmlAttributes.join(' ')),
                 sprintf(' id="%s"', $.isArray(item) ? undefined : item._id),
                 sprintf(' class="%s"', style.classes || ($.isArray(item) ? undefined : item._class)),
-                sprintf(' data-index="%s"', (true === appendBody ? dataLength + i : i)),
+                sprintf(' data-index="%s"', i),
                 sprintf(' data-uniqueid="%s"', item[this.options.uniqueId]),
                 sprintf('%s', data_),
                 '>'
@@ -2499,7 +2505,7 @@
             }
             if ($.inArray(row[params.field], params.values) !== -1) {
                 that.options.data.splice(i, 1);
-                if(that.options.fixInitBody && that.$body){
+                if(that.options.fixInitBody && that.fixDataIndex){
                 	that.$body.find(sprintf('tr[data-index="%s"]', i)).remove();
                 }
             }
@@ -2512,11 +2518,9 @@
         that.initSearch();
         that.initPagination();
         that.initSort();
-        if(that.options.fixInitBody && that.$body) {
+        if(that.options.fixInitBody && that.fixDataIndex) {
         	// fix data-index
-        	that.$body.find('tr[data-index]').each(function(idx, element){
-        		$(element).attr("data-index", idx);
-        	});
+        	that.fixDataIndex();
         } else {
         	that.initBody(true);
         }
@@ -2622,18 +2626,25 @@
     BootstrapTable.prototype.updateRow = function (params) {
         var that = this;
         var allParams = $.isArray(params) ? params : [params];
-
         $.each(allParams, function (i, params) {
             if (!params.hasOwnProperty('index') || !params.hasOwnProperty('row')) {
                 return;
             }
             $.extend(that.options.data[params.index], params.row);
         });
-
-        this.initSearch();
-        this.initSort();
-        this.initBody(true);
-    };
+        that.initSearch();
+        that.initSort();
+        if(that.options.fixInitBody && that.options.editable){
+        	var columns = that.columns;
+        	$.each(allParams, function(i, params) {
+        		$.each(params.row, function(fieldName, fieldValue) {
+        			that.$body.find(sprintf('tr[data-index="%s"]>td>a[data-name="%s"]', params.index, fieldName)).editable("setValue", fieldValue);
+        		});       	
+        	})
+        } else {
+        	that.initBody(true);
+        }
+	};
 
     BootstrapTable.prototype.showRow = function (params) {
         if (!params.hasOwnProperty('index') && !params.hasOwnProperty('uniqueId')) {
