<!DOCTYPE html>
<html lang="en">

<head>
    <title>自定义书签</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="./plugin/css/iview.css">
    <link rel="stylesheet" type="text/css" href="./plugin/vendor/zTree3.3/css/bootstrapStyle/bootstrapStyle.css">
    <script type="text/javascript" src="./plugin/js/vue.min.js"></script>
    <script type="text/javascript" src="./plugin/js/iview.min.js"></script>
    <script type="text/javascript" src="./plugin/js/config.js"></script>
    <script type="text/javascript" src="./plugin/vendor/jquery.min.js"></script>
    <script type="text/javascript" src='./js/main.js'></script>
</head>

<body>
    <div id="bookmark" class="layout" style="width:100%;height:100%">
        <Layout>
            <Header class="header">
                <Card>
                    <Row>书签名称：</Row>
                    <Row>
                        <i-select v-model="bookItem1" placeholder="选择书签" @on-change="getBookMark">
                            <!-- <i-option v-for="(item,key) in bookmarks " :value="item.bookmarksign" :key="key">{{item.bookmarkname}}</i-option> -->
                            <i-option v-for="(item,index) in bookmarks " :value="index" :label="item.bookmarkname" :key="index"></i-option>
                        </i-select>
                    </Row>
                </Card>
            </Header>
            <Content>
                <Card>
                    <div style="min-height: 200px;">
                        <div id="showResult" style="display: block">请先从上方的下拉列表中选择指定书签后，再进行添加或删除操作！</div>
                    </div>
                </Card>

            </Content>
            <Footer>
                <Card :style="{padding: '0 0px'}">
                    <div align="left" style="float:left">
                        <i-button size="large " id="add" type="primary " @click="addBookMark()">添加</i-button>
                        <i-button size="large " id="del" type="primary " @click="deletelFormField()">删除</i-button>
                    </div>
                    <div align="right">
                        <i-button size="large " type="primary " @click="cancle()">取消</i-button>
                    </div>
                    <div id="hiddenbk">
                        <i-input type="text" v-model="bookmarkPath" id="bookmarkPath" />
                    </div>
                </Card>
            </Footer>
        </Layout>
    </div>

</body>

<script>
    var vuedata = new Vue({
        el: '#bookmark',
        data: {
            bookmarks: {},
            bookItem1: {},
            bookmarksign: "",
            bookmarkname: "",
        },
        methods: {

            cancle: function () {
                // $("#showResult").html("请先从上方的下拉列表中选择指定书签后，再进行添加或删除操作！");
                window.close();
            },
            getBookMark: function () {
                var _this = this;
                var bookmarkindex = _this.bookItem1;
                // _this.$Message.info(bookmarkindex)
                _this.bookmarksign = _this.bookmarks[bookmarkindex].bookmarksign;
                $("#showResult").html(" ");
                if (_this.bookmarksign) {
                    $("#add").attr('disabled', false);
                    $("#del").attr('disabled', false);
                }

            },
            addBookMark: function () {
                var _this = this;
                var bookmarkindex = _this.bookItem1;
                var bookmarkItem = _this.bookmarks[bookmarkindex];
                _this.bookmarksign = _this.bookmarks[bookmarkindex].bookmarksign;
                _this.bookmarkname = _this.bookmarks[bookmarkindex].bookmarkname;
                if (_this.bookmarksign) {
                    wps.ExecFunc('insertFormField(' + JSON.stringify(bookmarkItem) + ')');
                    $("#showResult").html("书签【" + _this.bookmarksign + "】添加成功！");
                }
            },
            deleteBookMark: function () {
                var _this = this;
                var bookmarkindex = _this.bookItem1;
                _this.bookmarksign = _this.bookmarks[bookmarkindex].bookmarksign;

                if (_this.bookmarksign) {
                    wps.ExecFunc('delBookmark(' + JSON.stringify(_this.bookmarksign) + ')');
                }
            },
            deletelFormField: function () {
                var _this = this;
                // _this.bookmarksign = JSON.stringify(_this.bookItem1);
                var bookmarkindex = _this.bookItem1;
                _this.bookmarksign = _this.bookmarks[bookmarkindex].bookmarksign;

                if (_this.bookmarksign) {
                    wps.ExecFunc('delFormField(' + JSON.stringify(_this.bookmarksign) + ')');
                }
            }

        },
        created: function () {
            $("#hiddenbk").hide();
            wps.ExecFunc('getAllBookmarklists()');
            $("#add").attr('disabled', true);
            $("#del").attr('disabled', true);
        }

    });
</script>
<style media="screen" type="text/css" scoped>
    .layout {
        border: 1px solid #d7dde4;
        background: #f5f7f9;
        position: relative;
        border-radius: 4px;
        overflow: hidden;
    }
</style>

</html>