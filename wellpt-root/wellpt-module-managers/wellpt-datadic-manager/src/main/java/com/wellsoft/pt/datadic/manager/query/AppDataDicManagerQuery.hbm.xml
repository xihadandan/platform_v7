<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>


    <!--模块数据字典查询-->
    <sql-query name="appModuleDataDicDefManagerQuery">
        <![CDATA[
    select t1.* from (
    select t1.uuid as uuid,
           t1.create_time as create_time,
           t1.creator as creator,
           t1.modifier as modifier,
           t1.modify_time as modify_time,
           t1.rec_ver as rec_ver,
           t1.name as name,
           t1.code as code,
           t1.type as type,
           t1.module_id as module_id,
           t1.seq as seq,
           t1.parent_uuid as parent_uuid,
           0 as is_ref
      from cd_data_dict t1
     where 1=1
        <if parentUuidIsNull ??> and t1.parent_uuid is null </if>
        <if parentUuidIsNotNull ??> and t1.parent_uuid is not null </if>
        <if parentUuid ??> and t1.parent_uuid =:parentUuid </if>
        <if moduleId??>
        and t1.module_id=:moduleId
		 </if>
		 <if uuid??>
        and t1.uuid=:uuid
		 </if>

    <if catchRefDataDic??>
    union

    select t1.uuid as uuid,
           t1.create_time as create_time,
           t1.creator as creator,
           t1.modifier as modifier,
           t1.modify_time as modify_time,
           t1.rec_ver as rec_ver,
           t1.name as name,
           t1.code as code,
           t1.type as type,
           t1.module_id as module_id,
           t1.seq as seq,
           rr.parent_uuid as parent_uuid,
           1 as is_ref
      from cd_data_dict t1, cd_data_dict_ref rr
     where rr.ref_uuid = t1.uuid
        <if parentUuidIsNull ??> and rr.parent_uuid is null </if>
        <if parentUuidIsNotNull ??> and rr.parent_uuid is not null </if>
        <if parentUuid ??> and rr.parent_uuid =:parentUuid </if>
        <if moduleId??>
             and rr.module_id=:moduleId
             and t1.module_id<>:moduleId
         </if>
        </if>
          ) t1
        <if isNotBlank(orderBy)>
            ${orderBy}
          </if>

    ]]>


    </sql-query>


</hibernate-mapping>