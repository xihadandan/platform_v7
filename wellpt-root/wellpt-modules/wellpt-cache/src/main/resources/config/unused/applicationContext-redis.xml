<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd"
       default-lazy-init="true">


    <!-- jedis缓存管理器 -->
    <bean class="com.wellsoft.pt.cache.jedis.JedisCacheManager" id="jedisCacheManager">
        <constructor-arg ref="jedisConnectionFactory"/>
    </bean>

    <bean class="redis.clients.jedis.JedisPoolConfig" id="jedisPoolConfig"
          p:maxTotal="${jedis.pool.maxTotal}"
          p:maxIdle="${jedis.pool.maxIdle}"
          p:minIdle="${jedis.pool.minIdle}"/>

    <!-- redis 哨兵模式配置：至少3个节点是合理的-->
    <!--<bean class="org.springframework.data.redis.connection.RedisSentinelConfiguration"
          id="redisSentinelConfiguration">
        <constructor-arg index="0" value="${redis.sentinel.master}"/>
        <constructor-arg index="1">
            <set>
                <value>${redis.sentinel.node-1}</value>
                <value>${redis.sentinel.node-2}</value>
                <value>${redis.sentinel.node-3}</value>
            </set>
        </constructor-arg>
    </bean>-->


    <!-- redis cluster集群配置：至少要求配置6个节点 -->
    <!--<bean class="org.springframework.data.redis.connection.RedisClusterConfiguration"
          id="redisClusterConfiguration">
        <constructor-arg>
            <set>
                <value>${redis.cluster.node-1}</value>
                <value>${redis.cluster.node-2}</value>
                <value>${redis.cluster.node-3}</value>
                <value>${redis.cluster.node-4}</value>
                <value>${redis.cluster.node-5}</value>
                <value>${redis.cluster.node-6}</value>
            </set>
        </constructor-arg>
        <property name="maxRedirects" value="${redis.max-redirects}"/>
    </bean>-->

    <bean id="jedisConnectionFactory"
          class="org.springframework.data.redis.connection.jedis.JedisConnectionFactory">

        <!-- ########### redis模式选择 ########### -->

        <!-- 1.单redis模式开始-->
        <property name="hostName" value="${redis.host}"/>
        <property name="port" value="${redis.port}"/>
        <!---->
        <!-- 单redis模式配置结束 -->

        <!-- 2.redis sentinel哨兵模式开始-->
        <!--<constructor-arg index="0" ref="redisSentinelConfiguration"/>-->
        <!--<constructor-arg index="1" ref="jedisPoolConfig"/>-->
        <!-- redis sentinel哨兵模式结束-->

        <!-- 3.redis-cluster集群模式开始-->
        <!--<constructor-arg index="0" ref="redisClusterConfiguration"/>-->
        <!--<constructor-arg index="1" ref="jedisPoolConfig"/>-->
        <!-- redis-cluster集群模式结束-->

        <!-- 以上三种模式任选一种-->
        <!-- ############################### -->

        <!-- 连接池-->
        <property name="poolConfig" ref="jedisPoolConfig"/>

    </bean>


</beans>